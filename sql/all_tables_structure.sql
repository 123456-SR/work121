-- 合并后的所有表结构定义
-- 包含：委托单、各类检测记录/报告表、目录表、用户表、签字表

-- 1. 原始委托单表 (JZS_ENTRUSTMENT)
CREATE TABLE JZS_ENTRUSTMENT (
    UNIFIED_NUMBER VARCHAR2(50) PRIMARY KEY,
    SAMPLE_NUMBER VARCHAR2(50),
    CLIENT_UNIT VARCHAR2(200),
    CLIENT_DATE DATE,
    CONSTRUCTION_UNIT VARCHAR2(200),
    BUILDING_UNIT VARCHAR2(200),
    PROJECT_NAME VARCHAR2(200),
    CONSTRUCTION_PART VARCHAR2(200),
    SAMPLE_NAME VARCHAR2(200),
    SPEC VARCHAR2(200),
    MANUFACTURER VARCHAR2(200),
    SAMPLE_QUANTITY VARCHAR2(50),
    REPRESENTATIVE_BATCH VARCHAR2(200),
    BATCH_NUMBER VARCHAR2(100),
    TEST_CATEGORY VARCHAR2(100),
    CLIENT_ADDRESS_PHONE VARCHAR2(200),
    REPORT_SEND VARCHAR2(100),
    SAMPLE_DISPOSAL VARCHAR2(100),
    WITNESS VARCHAR2(100),
    WITNESS_UNIT VARCHAR2(200),
    DELIVERY_MODE VARCHAR2(50),
    DELIVERY_DATE1_Y VARCHAR2(10),
    DELIVERY_DATE1_M VARCHAR2(10),
    DELIVERY_DATE1_D VARCHAR2(10),
    DELIVERY_DATE2_Y VARCHAR2(10),
    DELIVERY_DATE2_M VARCHAR2(10),
    DELIVERY_DATE2_D VARCHAR2(10),
    FEE VARCHAR2(50),
    REMARKS VARCHAR2(500),
    SAMPLE_HISTORY VARCHAR2(500),
    SAMPLE_STATUS VARCHAR2(500),
    TEST_ITEMS VARCHAR2(500)
);

-- 2. 新委托单表 (T_ENTRUSTMENT) - 包含完整业务字段及签名照片字段
CREATE TABLE T_ENTRUSTMENT (
    -- 主键
    id VARCHAR2(36) PRIMARY KEY,
    -- 核心公共字段
    wt_num VARCHAR2(36),
    sample_name VARCHAR2(255),
    test_category VARCHAR2(100),
    client_unit VARCHAR2(255),
    client VARCHAR2(100),
    client_tel VARCHAR2(50),
    client_unit_postalcode VARCHAR2(20),
    client_unit_person VARCHAR2(100),
    project_name VARCHAR2(255),
    construction_part VARCHAR2(255),
    project_area VARCHAR2(100),
    building_unit VARCHAR2(255),
    survey_unit VARCHAR2(255),
    construction_unit VARCHAR2(255),
    witness_unit VARCHAR2(255),
    witness VARCHAR2(100),
    supervision_unit VARCHAR2(255),
    design_unit VARCHAR2(255),
    commission_date DATE,
    -- 业务字段
    customer_id VARCHAR2(36),
    data_cid VARCHAR2(36),
    yw_department_id VARCHAR2(36),
    dest_department_id VARCHAR2(36),
    report_send_dept VARCHAR2(100),
    dest_user_id VARCHAR2(36),
    report_send_user VARCHAR2(100),
    client_unit_id VARCHAR2(36),
    client_unit_address VARCHAR2(500),
    client_unit_tel VARCHAR2(50),
    contract_code VARCHAR2(100),
    project_payment VARCHAR2(50),
    project_code VARCHAR2(100),
    project_address VARCHAR2(500),
    building_unit_id VARCHAR2(36),
    survey_unit_id VARCHAR2(36),
    construction_code VARCHAR2(100),
    construction_unit_id VARCHAR2(36),
    project_supervise_id VARCHAR2(36),
    witness_unit_id VARCHAR2(36),
    supervise_dept VARCHAR2(100),
    witness_id VARCHAR2(36),
    witness_tel VARCHAR2(50),
    supervision_unit_id VARCHAR2(36),
    building_man_id VARCHAR2(36),
    building_man VARCHAR2(100),
    building_man_tel VARCHAR2(50),
    building_unit_id2 VARCHAR2(36),
    building_unit2 VARCHAR2(255),
    yw_man_id VARCHAR2(36),
    receiver VARCHAR2(100),
    standard_money VARCHAR2(50),
    discount_money VARCHAR2(50),
    real_money VARCHAR2(50),
    invoice_money VARCHAR2(50),
    transfer_money VARCHAR2(50),
    direct_money VARCHAR2(50),
    reallocate_money VARCHAR2(50),
    account_number VARCHAR2(100),
    remarks VARCHAR2(2000),
    settle_status VARCHAR2(20),
    remaining_money VARCHAR2(50),
    back_money VARCHAR2(50),
    to_zh_money VARCHAR2(50),
    already_money VARCHAR2(50),
    sample_status VARCHAR2(20),
    virtual_money VARCHAR2(50),
    test_items VARCHAR2(2000),
    building_area VARCHAR2(100),
    building_nature VARCHAR2(100),
    building_floor VARCHAR2(50),
    construction_unit_sub VARCHAR2(255),
    old_org VARCHAR2(100),
    spec VARCHAR2(255),
    project_supervision VARCHAR2(100),
    project_director VARCHAR2(100),
    batch_number VARCHAR2(100),
    station_id VARCHAR2(36),
    supervision_man VARCHAR2(100),
    manufacturer VARCHAR2(255),
    witness_method VARCHAR2(50),
    client_reg_id VARCHAR2(36),
    client_reg_name VARCHAR2(100),
    sampling_unit VARCHAR2(255),
    sampling_man VARCHAR2(100),
    sampling_man_id VARCHAR2(36),
    structure_type VARCHAR2(100),
    structure_floor VARCHAR2(50),
    sampling_place VARCHAR2(500),
    province VARCHAR2(100),
    city VARCHAR2(100),
    area VARCHAR2(100),
    project_area_code VARCHAR2(100),
    project_type VARCHAR2(100),
    project_num VARCHAR2(100),
    design_unit_id VARCHAR2(36),
    sampling_man2 VARCHAR2(100),
    pay_unit VARCHAR2(255),
    sampling_man_code VARCHAR2(100),
    contract_code_interaction VARCHAR2(100),
    pay_unit_num VARCHAR2(100),
    last_update TIMESTAMP,
    inspect_type VARCHAR2(50),
    client_reg_date TIMESTAMP,
    module_name VARCHAR2(100),
    jc_task_js_man_id VARCHAR2(36),
    jc_task_js_man VARCHAR2(100),
    jc_task_reg_man_id VARCHAR2(36),
    jc_task_reg_man VARCHAR2(100),
    jc_task_reg_date TIMESTAMP,
    jc_task_status VARCHAR2(20),
    jc_task_sh_man_id VARCHAR2(36),
    jc_task_sh_man VARCHAR2(100),
    is_produce_gd VARCHAR2(10),
    produce_gd_man_id VARCHAR2(36),
    produce_gd_man VARCHAR2(100),
    produce_gd_date TIMESTAMP,
    report_deliver_num VARCHAR2(20),
    yw_man VARCHAR2(100),
    yw_man_id2 VARCHAR2(36),
    yw_area VARCHAR2(100),
    building_unit_contact VARCHAR2(100),
    building_unit_contact_tel VARCHAR2(50),
    supervision_unit_contact_tel VARCHAR2(50),
    survey_unit_contact VARCHAR2(100),
    survey_unit_contact_tel VARCHAR2(50),
    construction_unit_contact VARCHAR2(100),
    construction_unit_contact_tel VARCHAR2(50),
    project_contact_tel VARCHAR2(50),
    design_unit_contact VARCHAR2(100),
    design_unit_contact_tel VARCHAR2(50),
    jc_task_xd_man_id VARCHAR2(36),
    jc_task_xd_man VARCHAR2(100),
    jc_task_xd_date TIMESTAMP,
    sk_number VARCHAR2(100),
    xc_wt_num VARCHAR2(100),
    test_place VARCHAR2(255),
    send_back_reason VARCHAR2(2000),
    send_back_man_id VARCHAR2(36),
    send_back_man VARCHAR2(100),
    project_remarks VARCHAR2(2000),
    car_type VARCHAR2(50),
    yw_source VARCHAR2(50),
    blind_number VARCHAR2(100),
    jc_date TIMESTAMP,
    project_supervise_code VARCHAR2(100),
    contract_phase VARCHAR2(50),
    client_serial_num VARCHAR2(100),
    pqt_plan_no VARCHAR2(100),
    contract_id VARCHAR2(36),
    jc_task_tj_man_id VARCHAR2(36),
    jc_task_tj_man VARCHAR2(100),
    jc_task_tj_date TIMESTAMP,
    zs_unit VARCHAR2(255),
    zs_unit_address VARCHAR2(500),
    customer_name VARCHAR2(255),
    nc_code VARCHAR2(100),
    witness_id_card VARCHAR2(50),
    sampling_man_id_card VARCHAR2(50),
    record_customer VARCHAR2(255),
    record_nc VARCHAR2(100),
    income_cost_type VARCHAR2(50),
    yp_code VARCHAR2(100),
    mediation_contract VARCHAR2(100),
    mediation_discount VARCHAR2(50),
    
    -- 签名照片字段
    review_signature_photo VARCHAR2(500),
    inspect_signature_photo VARCHAR2(500),
    approve_signature_photo VARCHAR2(500)
);

-- 3. 轻型动力触探检测记录表 (JZS_LIGHT_DYNAMIC_PENETRATION)
CREATE TABLE JZS_LIGHT_DYNAMIC_PENETRATION (
    UNIFIED_NUMBER VARCHAR2(50) PRIMARY KEY,
    ENTRUSTING_UNIT VARCHAR2(200),
    PROJECT_NAME VARCHAR2(200),
    ENTRUST_DATE VARCHAR2(20),
    CONSTRUCTION_PART VARCHAR2(200),
    TEST_DATE VARCHAR2(20),
    SOIL_PROPERTY VARCHAR2(200),
    REPORT_DATE VARCHAR2(20),
    WITNESS_UNIT VARCHAR2(200),
    WITNESS VARCHAR2(100),
    DESIGN_CAPACITY VARCHAR2(50),
    HAMMER_WEIGHT VARCHAR2(50),
    DROP_DISTANCE VARCHAR2(50),
    TEST_CATEGORY VARCHAR2(100),
    TEST_BASIS VARCHAR2(500),
    EQUIPMENT VARCHAR2(500),
    REMARKS VARCHAR2(500),
    APPROVE VARCHAR2(100),
    REVIEW VARCHAR2(100),
    INSPECT VARCHAR2(100),
    COMPANY_NAME VARCHAR2(200),
    COMPANY_ADDRESS VARCHAR2(500),
    COMPANY_PHONE VARCHAR2(100),
    CONCLUSION VARCHAR2(1000),
    DATA_BLOCKS CLOB,
    REVIEWER VARCHAR2(100),
    INSPECTOR VARCHAR2(100),
    APPROVER VARCHAR2(100),
    PAGE NUMBER,
    TOTAL_PAGES NUMBER,
    CREATE_TIME TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CREATOR VARCHAR2(100),
    REVIEW_SIGNATURE_PHOTO VARCHAR2(500),
    INSPECT_SIGNATURE_PHOTO VARCHAR2(500),
    APPROVE_SIGNATURE_PHOTO VARCHAR2(500)
);

-- 4. 用户表 (JZS_USERS)
CREATE TABLE JZS_USERS (
    USER_ID VARCHAR2(50) PRIMARY KEY,
    USER_ACCOUNT VARCHAR2(50) UNIQUE NOT NULL,
    USER_PASS VARCHAR2(100),
    USER_NAME VARCHAR2(100),
    USER_STATUS VARCHAR2(10)
);

-- 5. 回弹法检测表 (T_REBOUND_METHOD)
CREATE TABLE T_REBOUND_METHOD (
    id VARCHAR2(36) PRIMARY KEY,
    entrustment_id VARCHAR2(36) NOT NULL,
    structure_part VARCHAR2(255),
    concrete_grade VARCHAR2(50),
    molding_date DATE,
    age VARCHAR2(50),
    instrument_model VARCHAR2(100),
    calibration_no VARCHAR2(100),
    zone_count VARCHAR2(20),
    pouring_direction VARCHAR2(50),
    test_angle VARCHAR2(50),
    pumping_method VARCHAR2(50),
    pumping VARCHAR2(20),
    design_strength VARCHAR2(50),
    carbonation_depth VARCHAR2(50),
    test_result VARCHAR2(2000),
    data_json CLOB
);

-- 6. 极简目录表 (T_SIMPLE_DIRECTORY)
CREATE TABLE T_SIMPLE_DIRECTORY (
    ID VARCHAR2(50) PRIMARY KEY,
    DIR_ID VARCHAR2(50),
    DIR_NAME VARCHAR2(200),
    TABLE1_TYPE VARCHAR2(50),
    TABLE1_ID VARCHAR2(50),
    TABLE2_TYPE VARCHAR2(50),
    TABLE2_ID VARCHAR2(50),
    TABLE3_TYPE VARCHAR2(50),
    TABLE3_ID VARCHAR2(50),
    TABLE4_TYPE VARCHAR2(50),
    TABLE4_ID VARCHAR2(50),
    TABLE5_TYPE VARCHAR2(50),
    TABLE5_ID VARCHAR2(50),
    TABLE6_TYPE VARCHAR2(50),
    TABLE6_ID VARCHAR2(50),
    TABLE7_TYPE VARCHAR2(50),
    TABLE7_ID VARCHAR2(50),
    TABLE8_TYPE VARCHAR2(50),
    TABLE8_ID VARCHAR2(50),
    TABLE9_TYPE VARCHAR2(50),
    TABLE9_ID VARCHAR2(50),
    TABLE10_TYPE VARCHAR2(50),
    TABLE10_ID VARCHAR2(50),
    STATUS NUMBER,
    CREATE_MAN VARCHAR2(50),
    CREATE_TIME TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATE_MAN VARCHAR2(50),
    UPDATE_TIME TIMESTAMP
);

-- 7. 灌砂法检测表 (T_SAND_REPLACEMENT)
CREATE TABLE T_SAND_REPLACEMENT (
    ID VARCHAR2(50) PRIMARY KEY,
    ENTRUSTMENT_ID VARCHAR2(50),
    SOIL_TYPE VARCHAR2(100),
    PIT_VOLUME VARCHAR2(50),
    WET_WEIGHT VARCHAR2(50),
    DRY_WEIGHT VARCHAR2(50),
    WATER_CONTENT VARCHAR2(50),
    WET_DENSITY VARCHAR2(50),
    DRY_DENSITY VARCHAR2(50),
    MAX_DRY_DENSITY VARCHAR2(50),
    MIN_DRY_DENSITY VARCHAR2(50),
    COMPACTION_COEFFICIENT VARCHAR2(50),
    QUALIFIED_RATE VARCHAR2(50),
    DATA_JSON CLOB
);

-- 8. 灌水法检测表 (T_WATER_REPLACEMENT)
CREATE TABLE T_WATER_REPLACEMENT (
    ID VARCHAR2(50) PRIMARY KEY,
    ENTRUSTMENT_ID VARCHAR2(50),
    SOIL_TYPE VARCHAR2(100),
    PIT_VOLUME VARCHAR2(50),
    WET_WEIGHT VARCHAR2(50),
    DRY_WEIGHT VARCHAR2(50),
    WATER_CONTENT VARCHAR2(50),
    WET_DENSITY VARCHAR2(50),
    DRY_DENSITY VARCHAR2(50),
    MAX_DRY_DENSITY VARCHAR2(50),
    COMPACTION_COEFFICIENT VARCHAR2(50),
    QUALIFIED_RATE VARCHAR2(50),
    DATA_JSON CLOB
);

-- 9. 贝克曼梁法检测表 (T_BECKMAN_BEAM)
CREATE TABLE T_BECKMAN_BEAM (
    ID VARCHAR2(50) PRIMARY KEY,
    ENTRUSTMENT_ID VARCHAR2(50),
    SUBGRADE_TYPE VARCHAR2(100),
    DEFLECTOMETER_TYPE VARCHAR2(100),
    AXLE_WEIGHT VARCHAR2(50),
    TIRE_PRESSURE VARCHAR2(50),
    TEST_LENGTH VARCHAR2(50),
    DATA_JSON CLOB
);

-- 10. 密度试验表 (T_DENSITY_TEST)
CREATE TABLE T_DENSITY_TEST (
    ID VARCHAR2(50) PRIMARY KEY,
    ENTRUSTMENT_ID VARCHAR2(50),
    SOIL_TYPE VARCHAR2(100),
    RING_VOLUME VARCHAR2(50),
    WET_WEIGHT VARCHAR2(50),
    DRY_WEIGHT VARCHAR2(50),
    WATER_CONTENT VARCHAR2(50),
    WET_DENSITY VARCHAR2(50),
    DRY_DENSITY VARCHAR2(50),
    MAX_DRY_DENSITY VARCHAR2(50),
    MIN_DRY_DENSITY VARCHAR2(50),
    OPTIMUM_MOISTURE VARCHAR2(50),
    COMPACTION_COEFFICIENT VARCHAR2(50),
    QUALIFIED_RATE VARCHAR2(50),
    SAMPLE_NAME_STATUS VARCHAR2(200),
    DESIGN_INDEX VARCHAR2(100),
    TEST_RESULT VARCHAR2(500),
    DATA_JSON CLOB
);

-- 11. 核子密度仪法检测表 (T_NUCLEAR_DENSITY)
CREATE TABLE T_NUCLEAR_DENSITY (
    ID VARCHAR2(50) PRIMARY KEY,
    ENTRUSTMENT_ID VARCHAR2(50),
    NUCLEAR_MODEL VARCHAR2(100),
    TEST_DEPTH VARCHAR2(50),
    DATA_JSON CLOB
);

-- 12. 环刀法检测表 (T_CUTTING_RING)
CREATE TABLE T_CUTTING_RING (
    ID VARCHAR2(50) PRIMARY KEY,
    ENTRUSTMENT_ID VARCHAR2(50),
    SOIL_TYPE VARCHAR2(100),
    RING_VOLUME VARCHAR2(50),
    WET_WEIGHT VARCHAR2(50),
    DRY_WEIGHT VARCHAR2(50),
    WATER_CONTENT VARCHAR2(50),
    WET_DENSITY VARCHAR2(50),
    DRY_DENSITY VARCHAR2(50),
    MAX_DRY_DENSITY VARCHAR2(50),
    COMPACTION_COEFFICIENT VARCHAR2(50),
    QUALIFIED_RATE VARCHAR2(50),
    DATA_JSON CLOB
);

-- 13. 签字存放表 (JZS_SIGNATURE)
CREATE TABLE JZS_SIGNATURE (
    SIGNATURE_ID VARCHAR2(36) PRIMARY KEY,
    USER_ACCOUNT VARCHAR2(36) NOT NULL,
    SIGNATURE_TYPE VARCHAR2(50) NOT NULL,
    SIGNATURE_BLOB BLOB NOT NULL,
    IMAGE_TYPE VARCHAR2(20) NOT NULL,
    IMAGE_SIZE NUMBER NOT NULL,
    IMAGE_WIDTH NUMBER,
    IMAGE_HEIGHT NUMBER,
    CREATE_TIME TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATE_TIME TIMESTAMP,
    REMARKS VARCHAR2(500),
    CONSTRAINT FK_SIGNATURE_USER FOREIGN KEY (USER_ACCOUNT) REFERENCES JZS_USERS(USER_ACCOUNT),
    CONSTRAINT UK_SIGNATURE_USER_TYPE UNIQUE (USER_ACCOUNT, SIGNATURE_TYPE)
);

-- 索引
CREATE INDEX IDX_JZS_ENTRUSTMENT_SAMPLE ON JZS_ENTRUSTMENT(SAMPLE_NUMBER);
CREATE INDEX IDX_JZS_ENTRUSTMENT_CLIENT ON JZS_ENTRUSTMENT(CLIENT_UNIT);
CREATE INDEX IDX_JZS_LIGHT_DYNAMIC_PROJECT ON JZS_LIGHT_DYNAMIC_PENETRATION(PROJECT_NAME);
CREATE INDEX IDX_JZS_LIGHT_DYNAMIC_DATE ON JZS_LIGHT_DYNAMIC_PENETRATION(TEST_DATE);
